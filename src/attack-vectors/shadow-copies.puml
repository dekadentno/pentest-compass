@startuml
actor "Domain Admin"
participant "Domain Controller\nwith vshadow" as DC
database "Shadow\nCopy" as ShadowCopy
participant "Attacker's\nLocal Machine" as LocalMachine

group Prerequisites
    note over "Domain Admin", DC
        - Domain Admin privileges are required.
        - vshadow.exe must be present on the Domain Controller.
        - The Domain Controller must have the Volume Shadow Copy Service enabled.
    end note
end group

"Domain Admin" -> DC: Initiate Shadow Copy using vshadow.exe
note right of DC
    Domain Admin creates a Shadow Copy of the NTDS.dit file 
    using the vshadow.exe.
end note
DC -> ShadowCopy: Create Shadow Copy of NTDS.dit
note right of ShadowCopy
    A Shadow Copy of the Active Directory Database 
    (NTDS.dit) is created.
end note
"Domain Admin" -> LocalMachine: Transfer NTDS.dit Copy
note right of LocalMachine
    The extracted NTDS.dit file is transferred to 
    the attacker's local machine for offline analysis.
end note
LocalMachine -> LocalMachine: Extract User Credentials
note right of LocalMachine
    Credentials for every user in the domain are 
    extracted from the NTDS.dit file.
end note
@enduml