@startuml
actor Attacker
participant "Attacker's\nMachine" as AttackerMachine
participant "Target\nDomain Controller" as TargetDC

group Prerequisites
    note over Attacker, TargetDC
        - Attacker must have obtained the NTLM hash of a user's password.
        - The user whose hash is obtained should have valid access in the domain.
    end note
end group

Attacker -> AttackerMachine: Use NTLM Hash
note right of AttackerMachine
    The attacker uses the NTLM hash 
    to create an authentication session.
end note
AttackerMachine -> TargetDC: Request Kerberos TGT
note right of TargetDC
    The attacker's machine requests a Kerberos Ticket 
    Granting Ticket (TGT) from the Domain Controller.
end note
TargetDC --> AttackerMachine: Grant Kerberos TGT
note right of AttackerMachine
    If the hash is valid, the Domain Controller issues
    a Kerberos TGT to the attacker's machine.
end note
@enduml