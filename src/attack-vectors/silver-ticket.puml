@startuml
actor Attacker
participant "Attacker's\nComputer" as AttackerClient
participant "Service with\nSPN (Service Account)" as Service
participant "Domain Controller\n(KDC)" as KDC

Attacker -> AttackerClient: Collect Necessary Information
note right of AttackerClient
    The attacker gathers:
    1. SPN Password Hash
    2. Domain SID
    3. Target SPN
    This information is crucial to forge a Silver Ticket.
end note
AttackerClient -> AttackerClient: Forge Silver Ticket
note right of AttackerClient
    Using the SPN Password Hash, Domain SID, and Target SPN,
    the attacker creates a forged Silver Ticket,
    including fake group memberships for elevated privileges.
end note
AttackerClient -> Service: Present Silver Ticket
note right of Service
    The service checks the ticket's validity based on encryption.
    It does not verify user/group permissions within the ticket.
end note
Service -> Service: Grant Access Based on Forged Ticket
note right of Service
    The attacker gains access with the privileges
    in the forged Silver Ticket.
end note
@enduml