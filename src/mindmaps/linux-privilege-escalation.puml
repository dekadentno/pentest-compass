@startmindmap
+ Linux Privilege Escalation
++ Manual
+++ OS
++++ Details
+++++_ uname -romi
+++++_ cat /etc/*release
+++++_ cat /etc/issue
+++++_ <back:lightgreen> searchsploit for kernel and os vulns
++++ Sensitive files and directories
+++++_ /etc/passwd
+++++_ /etc/shadow
+++++_ /etc/fstab
+++++_ /etc/issue
+++++_ /.ssh
+++++_ <back:lightgreen> SUID flags, write permisions
+++ Users
++++ Current User
+++++_ id
+++++_ sudo -l
++++ Credentials
+++++ Reused Passwords
+++++ From Config Files
++++++_ cat ~/.ssh/authorized_keys; cat ~/.ssh/id_rsa
+++++ From Terminal History
++++++_ ls -la ~/.*_history
+++++ From ENV Vars
++++++_ env | grep PASS
+++++ From user files
++++++_ find /home/joe -type f \(-name "*.txt" \) 2>/dev/null
+++ Groups
++++_ cat /etc/group
+++ Processes
++++ As Privileged Account
+++++_ ps aux | grep root
++++ With Insecure Permissions
+++++_ ps aux | awk '$1!="root" && $11!="/sbin/nologin" {print}'
+++ Services
++++ Daemons
++++_ systemctl list-units --type=service
+++ Tasks
++++ Scheduled Tasks
+++++_ crontab -l; for user in $(cut -f1 -d: /etc/passwd); do crontab -u $user -l; done
+++++_ ls -alh /etc/cron*
+++++_ crontab -l
+++++_ <back:lightgreen> write permissions, running with elevated privileges
++++ Startup Tasks
+++++_ ls -l /etc/rc*.d/
+++ Network
++++ Adapters
+++++_ ip a
++++ Routing Tables
+++++_ routel
++++ Active Connections
+++++_ ss -anp
++++ Interfaces
+++++_ ifconfig -a
+++++ AV
+++++ Virtualization
++++ Routes
+++++_ ip route
++++ Open Ports
+++++_ netstat -tuln
+++++ Loopback
+++++ Routable Interface
++++ Firewall
+++++_ iptables -L
+++ Apps and Components
++++_ hard-coded credentials for a service with higher privileges
++++ Sudo
+++++_ sudo -l
+++++_ <back:lightgreen> GTFObins for utilities listed as allowing sudo commands (sudoers)
++++_ dpkg -l (Debian/Ubuntu) or rpm -qa (RedHat/CentOS)
+++ Drivers and Modules
++++_ lsmod
+++ Running Processes
++++_ ps aux
-- Automatic
---_ unix-privesc-check
---_ LinEnum
---_ linPEAS
---_ linux smart enumeration
---_ linuxprivchecker
---_ pentestmonkey/unix-privesc-check
@endmindmap