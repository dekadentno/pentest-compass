#!/bin/bash

: '
Usage: 
chmod 700 generate.sh
./generate.sh

Prerequisites: https://www.npmjs.com/package/node-plantuml
'

base_dir=$(dirname "$0")
dest_dir="${base_dir}/images"

mindmap_source_dir="${base_dir}/src/mindmaps"
attack_vectors_source_dir="${base_dir}/src/attack-vectors"
other_source_dir="${base_dir}/src/other-diagrams"

mkdir -p "$dest_dir"

for file in "${mindmap_source_dir}"/*.puml; do
    base_name=$(basename "$file" .puml)
    puml generate "$file" -o "${dest_dir}/${base_name}.png"
done

for file in "${attack_vectors_source_dir}"/*.puml; do
    base_name=$(basename "$file" .puml)
    puml generate "$file" -o "${dest_dir}/${base_name}.png"
done

for file in "${other_source_dir}"/*.puml; do
    base_name=$(basename "$file" .puml)
    puml generate "$file" -o "${dest_dir}/${base_name}.png"
done