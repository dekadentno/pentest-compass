@startuml
actor Attacker
participant "Attacker's\nMachine" as AttackerMachine
participant "Target\nServer" as TargetServer

group Prerequisites
    note over Attacker, TargetServer
        - SMB connection through the firewall.
        - Enabled Windows File and Printer Sharing.
        - ADMIN$ share available.
        - Local administrative rights or valid local admin credentials.
    end note
end group

Attacker -> AttackerMachine: Obtain NTLM Hash
note right of AttackerMachine
    The attacker captures the NTLM hash 
    of a user's password.
end note
AttackerMachine -> TargetServer: Authenticate using Hash
note right of TargetServer
    The attacker's machine uses the NTLM hash
    to authenticate to the target server
    without needing the plaintext password.
end note
TargetServer --> AttackerMachine: Grant Access
note right of AttackerMachine
    If the hash is valid, the target server grants
    access to the attacker, believing it's a legitimate user.
end note
@enduml