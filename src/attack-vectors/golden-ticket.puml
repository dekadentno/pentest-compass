@startuml
actor Attacker
participant "Attacker's\nMachine" as AttackerMachine
participant "Domain Controller\n(KDC)" as DC
database "AD\nDatabase" as ADDatabase

group Prerequisites
    note over Attacker, DC
        - Attacker must have obtained the krbtgt account's hash.
        - Attacker needs to know the domain SID.
    end note
end group

Attacker -> AttackerMachine: Generate Golden Ticket
note right of AttackerMachine
    The attacker creates a Golden Ticket using 
    the krbtgt hash and domain SID.
end note
AttackerMachine -> AttackerMachine: Inject Golden Ticket into Session
note right of AttackerMachine
    The Golden Ticket is injected into the attacker's 
    Kerberos ticket cache.
end note
AttackerMachine -> ADDatabase: Access Resources
note right of ADDatabase
    Using the Golden Ticket, the attacker accesses 
    various resources in the AD environment 
    without further authentication.
end note
ADDatabase --> AttackerMachine: Maintain Persistent Access
note right of AttackerMachine
    The Golden Ticket allows persistent access 
    even after reboots or credential changes.
end note
@enduml