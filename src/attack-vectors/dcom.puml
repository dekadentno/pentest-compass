@startuml
actor Attacker
participant "Attacker's\nMachine" as AttackerMachine
participant "Target\nWindows System" as TargetSystem
database "MMC\nApplication Class" as MMCApp
database "Application\nObjects" as AppObjects

group Prerequisites
    note over Attacker, TargetSystem
        - Attacker must have credentials for an account 
          authorized on the target system (typically a local admin).
        - DCOM must be enabled and accessible on the target system.
    end note
end group

Attacker -> AttackerMachine: Initiate DCOM Connection
note right of AttackerMachine
    The attacker establishes a DCOM connection 
    to the target Windows system.
end note
AttackerMachine -> MMCApp: Access MMC Application Class
note right of MMCApp
    The MMC Application Class is used to create
    Application Objects for automation.
end note
MMCApp -> AppObjects: Create Application Object
note right of AppObjects
    An Application Object is created, which has
    the ExecuteShellCommand method.
end note
AppObjects -> TargetSystem: ExecuteShellCommand Method
note right of TargetSystem
    The ExecuteShellCommand method under Document.ActiveView
    is used to execute shell commands on the target system.
end note
TargetSystem --> AttackerMachine: Send Execution Results
note right of AttackerMachine
    The target system executes the command and
    returns the results to the attacker's machine.
end note
@enduml