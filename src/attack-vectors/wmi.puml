@startuml
actor Attacker
participant "Attacker's\nMachine" as AttackerMachine
participant "Target\nMachine" as TargetMachine
database "WMI\nRepository" as WMIRepo

group Prerequisite
    note over Attacker, TargetMachine
        - Attacker must have credentials for a member 
          of the Administrators local group (domain user).
    end note
end group

Attacker -> AttackerMachine: Initiate WMI Command
note right of AttackerMachine
    The attacker uses a tool or script 
    to send a WMI command.
end note
AttackerMachine -> TargetMachine: WMI Query/Command
note right of TargetMachine
    The Target Machine receives the WMI command. 
    Authentication with Administrator credentials is required.
end note
TargetMachine -> WMIRepo: Access WMI Repository
note right of WMIRepo
    The WMI Repository processes the command, 
    which might involve querying system information,
    executing scripts, or changing settings.
end note
WMIRepo --> TargetMachine: Return Results
TargetMachine --> AttackerMachine: Send Results/Confirmation
note right of AttackerMachine
    The attacker's machine receives the output
    or confirmation of the executed command.
end note
@enduml
